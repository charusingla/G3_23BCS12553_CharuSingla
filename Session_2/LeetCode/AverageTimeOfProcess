--- Charu Singla : 23BCS12553 ---
SELECT DISTINCT machine_id, ROUND(
(SUM(CASE WHEN activity_type = 'end' THEN timestamp ELSE -timestamp end) :: NUMERIC(10, 3)) /
(COUNT(DISTINCT process_id)), 3)
AS processing_time
FROM Activity
GROUP BY machine_id;